<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Muscle Map – Anatomic Muscle Study</title>
  <style>
    /* Reset & base */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; background: #464343; color: #222; }

    /* Two-column layout */
    .container {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    .viewer {
      flex: 1;
      position: relative;
      background: #464343;
    }
    .sidebar {
      width: 350px;
      background: #e0e0e0;
      padding: 20px;
      overflow-y: auto;
    }

    /* Sketchfab iframe fills viewer */
    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* Quick-view tooltip style */
    .tooltip {
      position: absolute;
      background: #fff;
      color: #000;
      border: 2px solid #000;
      border-radius: 15px;
      padding: 10px;
      min-width: 150px;
      max-width: 200px;
      display: none;
      pointer-events: none;
      z-index: 10;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .tooltip h4 {
      margin-bottom: 8px;
      font-size: 16px;
    }
    .tooltip img {
      width: 100%;
      border-radius: 10px;
      margin-bottom: 6px;
    }

    /* Sidebar details */
    .sidebar h1 {
      margin-bottom: 10px;
      font-size: 24px;
    }
    .sidebar img {
      width: 100%;
      margin: 10px 0;
    }
    .sidebar p {
      margin-bottom: 12px;
      line-height: 1.4;
    }
    .sidebar ul {
      list-style: disc inside;
    }
    #closeSidebar {
      font-size: 24px;
      background: none;
      border: none;
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="viewer">
      <iframe id="modelFrame"
        src="https://sketchfab.com/models/fad4065844d8403787ea6cf4a2bdb31b/embed"
        title="Anatomic Muscle Study"
        allow="autoplay; fullscreen; xr-spatial-tracking" allowfullscreen>
      </iframe>
      <div class="tooltip" id="tooltip">
        <h4 id="tooltipName"></h4>
        <!-- optional image: <img id="tooltipImg" src="" alt=""> -->
      </div>
    </div>

    <div class="sidebar" id="sidebar">
      <button id="closeSidebar">×</button>
      <h1 id="muscleName">Select a Muscle</h1>
      <img id="muscleImg" src="" alt="Muscle Illustration" style="display:none;">
      <p id="muscleDesc">Hover over the 3D model to see a quick preview; click to view details here.</p>
      <h3>Exercises</h3>
      <ul id="muscleList"><li>No muscle selected</li></ul>
    </div>
  </div>

  <!-- Sketchfab Viewer SDK -->
  <script src="https://static.sketchfab.com/api/sketchfab-viewer-1.12.1.js"></script>
  <script>
    const iframe = document.getElementById('modelFrame');
    const tooltip = document.getElementById('tooltip');
    const tooltipName = document.getElementById('tooltipName');
    const sidebar = document.getElementById('sidebar');
    const closeBtn = document.getElementById('closeSidebar');
    const muscleName = document.getElementById('muscleName');
    const muscleDesc = document.getElementById('muscleDesc');
    const muscleList = document.getElementById('muscleList');

    // Map Sketchfab node names to details
    const muscleInfo = {
      'Pectoralis Major': {
        name: 'Pectoralis Major',
        desc: 'Part of the chest. Responsible for arm flexion, adduction, and internal rotation.',
        img: 'https://i.imgur.com/9nX_OTl.jpg', // placeholder muscle illustration
        exercises: ['Bench Press', 'Dumbbell Press', 'Incline Fly']
      }
      // add additional muscles here
    };

    const client = new Sketchfab('1.12.1', iframe);
    client.init('fad4065844d8403787ea6cf4a2bdb31b', {
      success(api) {
        api.start();
        api.addEventListener('viewerready', () => {
          // Hover preview
          api.addEventListener('hoverNode', event => {
            api.getNodeMap(nodeMap => {
              const name = nodeMap[event.nodeId] || 'Unknown';
              tooltipName.innerText = name;
              const { left, top, width } = iframe.getBoundingClientRect();
              tooltip.style.left = (left + width / 2) + 'px';
              tooltip.style.top = (top + 10) + 'px';
              tooltip.style.display = 'block';
            });
          });
          api.addEventListener('hoverNodeOut', () => {
            tooltip.style.display = 'none';
          });

          // Click for details
          api.addEventListener('clickNode', event => {
            api.getNodeMap(nodeMap => {
              const nodeName = nodeMap[event.nodeId] || 'Unknown';
              const info = muscleInfo[nodeName];
              muscleName.innerText = info ? info.name : nodeName;
              muscleDesc.innerText = info ? info.desc : 'No description available.';

              // image
              const imgEl = document.getElementById('muscleImg');
              if (info && info.img) {
                imgEl.src = info.img;
                imgEl.style.display = 'block';
              } else {
                imgEl.style.display = 'none';
              }

              // exercises list
              muscleList.innerHTML = '';
              const items = info ? info.exercises : ['No exercises available'];
              items.forEach(ex => {
                const li = document.createElement('li');
                li.innerText = ex;
                muscleList.appendChild(li);
              });

              sidebar.style.display = 'block';
              tooltip.style.display = 'none';
            });
          });
        });
      },
      error() { console.error('Sketchfab API init error'); }
    });

    closeBtn.addEventListener('click', () => { sidebar.style.display = 'none'; });
  </script>
</body>
</html>
